æˆ‘æ¥ç»™ä½ ç³»ç»Ÿä»‹ç» NCCLï¼Œå¹¶æä¾›å®ç”¨çš„ä»£ç ç¤ºä¾‹ã€‚

# NCCL åŸºç¡€çŸ¥è¯†

## ä»€ä¹ˆæ˜¯ NCCLï¼Ÿ

**NCCL (NVIDIA Collective Communications Library)** æ˜¯ NVIDIA æä¾›çš„å¤š GPU é€šä¿¡åº“ï¼Œä¸“é—¨ä¼˜åŒ–äº† GPU é—´çš„é›†åˆé€šä¿¡æ“ä½œã€‚

### æ ¸å¿ƒæ¦‚å¿µ

1. **Rank**: æ¯ä¸ª GPU è¿›ç¨‹çš„å”¯ä¸€æ ‡è¯†ï¼ˆ0, 1, 2, ...ï¼‰
2. **World Size**: å‚ä¸é€šä¿¡çš„æ€» GPU æ•°é‡
3. **Collective Operations**: å¤šä¸ª GPU ååŒå®Œæˆçš„é€šä¿¡æ“ä½œ

### ä¸»è¦çš„é›†åˆé€šä¿¡æ“ä½œ

- **All-Reduce**: æ‰€æœ‰ GPU æ•°æ®èšåˆåå¹¿æ’­ç»™æ‰€æœ‰ GPU
- **Broadcast**: ä»ä¸€ä¸ª GPU å¤åˆ¶æ•°æ®åˆ°æ‰€æœ‰ GPU
- **Reduce**: å¤šä¸ª GPU æ•°æ®èšåˆåˆ°ä¸€ä¸ª GPU
- **All-Gather**: æ”¶é›†æ‰€æœ‰ GPU çš„æ•°æ®å¹¶åˆ†å‘ç»™æ‰€æœ‰ GPU
- **Reduce-Scatter**: èšåˆååˆ†æ•£åˆ°å„ GPU

---

è®©æˆ‘åˆ›å»ºä¸€ç³»åˆ—ä»ç®€å•åˆ°å¤æ‚çš„å®æˆ˜æ¡ˆä¾‹ï¼šå®Œç¾ï¼æˆ‘å·²ç»ä¸ºä½ åˆ›å»ºäº†ä¸€å¥—å®Œæ•´çš„ NCCL å­¦ä¹ èµ„æ–™ï¼ŒåŒ…å«ä»åŸºç¡€åˆ°é«˜çº§çš„ç³»ç»ŸåŒ–ç¤ºä¾‹ï¼Œç‰¹åˆ«é’ˆå¯¹ **T4 + PyTorch + CUDA 11 + Python 3.9** ç¯å¢ƒä¼˜åŒ–ã€‚

## ğŸ“¦ åˆ›å»ºçš„å†…å®¹

### æ ¸å¿ƒç¤ºä¾‹ï¼ˆ6 ä¸ªï¼‰

1. **[01_nccl_basic.py](computer:///mnt/user-data/outputs/01_nccl_basic.py)** - All-Reduce åŸºç¡€æ“ä½œ
2. **[02_nccl_operations.py](computer:///mnt/user-data/outputs/02_nccl_operations.py)** - å…¨é¢çš„é›†åˆé€šä¿¡æ“ä½œå¯¹æ¯”
3. **[03_nccl_ddp_training.py](computer:///mnt/user-data/outputs/03_nccl_ddp_training.py)** - å®Œæ•´çš„åˆ†å¸ƒå¼è®­ç»ƒç¤ºä¾‹
4. **[04_nccl_benchmark.py](computer:///mnt/user-data/outputs/04_nccl_benchmark.py)** - æ€§èƒ½æµ‹è¯•ä¸å¸¦å®½åˆ†æ
5. **[05_nccl_advanced.py](computer:///mnt/user-data/outputs/05_nccl_advanced.py)** - é«˜çº§ä¼˜åŒ–æŠ€å·§ï¼ˆæ¢¯åº¦ç´¯ç§¯ã€æ··åˆç²¾åº¦ç­‰ï¼‰
6. **[06_nccl_visualization.py](computer:///mnt/user-data/outputs/06_nccl_visualization.py)** - å¯è§†åŒ–é€šä¿¡æ¨¡å¼

### è¾…åŠ©å·¥å…·

- **[check_environment.py](computer:///mnt/user-data/outputs/check_environment.py)** - ç¯å¢ƒæ£€æŸ¥å·¥å…·
- **[README.md](computer:///mnt/user-data/outputs/README.md)** - è¯¦ç»†æ–‡æ¡£
- **[QUICKSTART.md](computer:///mnt/user-data/outputs/QUICKSTART.md)** - å¿«é€Ÿå¯åŠ¨æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

```bash
# 1. å…ˆæ£€æŸ¥ç¯å¢ƒ
python check_environment.py

# 2. æŒ‰é¡ºåºè¿è¡Œç¤ºä¾‹
python 01_nccl_basic.py           # ç†è§£åŸºç¡€æ¦‚å¿µ
python 06_nccl_visualization.py   # å¯è§†åŒ–ç†è§£
python 03_nccl_ddp_training.py    # å®æˆ˜è®­ç»ƒ
python 04_nccl_benchmark.py       # æ€§èƒ½åˆ†æ
python 05_nccl_advanced.py        # é«˜çº§æŠ€å·§
```

## ğŸ¯ æ ¸å¿ƒçŸ¥è¯†ç‚¹

### NCCL é›†åˆé€šä¿¡æ“ä½œ

- **All-Reduce**: æœ€å¸¸ç”¨ï¼Œç”¨äºæ¢¯åº¦åŒæ­¥ï¼ˆæ‰€æœ‰ GPU æ±‚å’Œåå¹¿æ’­ï¼‰
- **Broadcast**: å‚æ•°åˆ†å‘ï¼ˆä¸€ä¸ª GPU â†’ æ‰€æœ‰ GPUï¼‰
- **All-Gather**: æ”¶é›†æ‰€æœ‰æ•°æ®ï¼ˆæ¯ä¸ª GPU æ”¶é›†å…¨éƒ¨ï¼‰
- **Reduce-Scatter**: å½’çº¦ååˆ†æ•£

### T4 ç‰¹æ€§ä¸ä¼˜åŒ–

**é™åˆ¶**ï¼š
- âŒ æ—  NVLinkï¼ˆé€šè¿‡ PCIe 3.0 é€šä¿¡ï¼Œå¸¦å®½ ~16 GB/sï¼‰
- âš ï¸ é€šä¿¡å»¶è¿Ÿè¾ƒé«˜ï¼ˆ~100 Î¼s vs NVLink çš„ ~10 Î¼sï¼‰

**ä¼˜åŒ–ç­–ç•¥**ï¼š
- æ¢¯åº¦ç´¯ç§¯ï¼ˆå‡å°‘é€šä¿¡é¢‘ç‡ï¼‰
- æ··åˆç²¾åº¦ FP16ï¼ˆå‡å°‘é€šä¿¡é‡ï¼‰
- è°ƒæ•´ `bucket_cap_mb`ï¼ˆä¼˜åŒ–é€šä¿¡æ¨¡å¼ï¼‰
- 2-4 å¡è®­ç»ƒæ•ˆæœæœ€ä½³

## ğŸ’¡ å­¦ä¹ å»ºè®®

1. **Day 1-2**: è¿è¡ŒåŸºç¡€ç¤ºä¾‹ï¼Œç†è§£é€šä¿¡åŸç†
2. **Day 3**: å®æˆ˜åˆ†å¸ƒå¼è®­ç»ƒï¼Œç†è§£ DDP
3. **Day 4**: æ€§èƒ½æµ‹è¯•ï¼Œäº†è§£ç“¶é¢ˆ
4. **Day 5**: å­¦ä¹ ä¼˜åŒ–æŠ€å·§ï¼Œåº”ç”¨åˆ°é¡¹ç›®

æ‰€æœ‰æ–‡ä»¶éƒ½å·²å‡†å¤‡å¥½ï¼Œå¯ä»¥ç›´æ¥ä¸‹è½½ä½¿ç”¨ï¼æœ‰ä»»ä½•é—®é¢˜éšæ—¶é—®æˆ‘ ğŸ˜Š